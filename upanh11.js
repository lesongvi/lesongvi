(function(b){function p(a){return a=1E9<=a?(a/1E9).toFixed(2)+" GB":1E6<=a?(a/1E6).toFixed(2)+" MB":1E3<=a?(a/1E3).toFixed(2)+" KB":1<a?a+" bytes":1==a?a+" byte":"0 byte"}function q(a){30<a.length&&(a=a.slice(0,15)+"..."+a.slice(a.length-10));return a}function c(){if(e.find("li").length){if(!e.find("li.loading").length&&b(".img_bbcode").length){var a=[];e.find("li").each(function(){var f=b(this);f.hasClass("success")?a.push(f.find(".img_bbcode").val()):a.push("L\u1ed7i \u1ea3nh "+f.find("img").data("name"))});r.val(a.join("\n\n"));t.val(b(".img_bbcode:first").data("thumb"));g.slideDown(function(){u.animate({scrollTop:g.offset().top})})}}else m.click()}var e=b("#img_list"),k=b("#img_upload"),m=b("#img_reset"),n=b("#img_choose_wrap"),g=b("#img_data"),u=b("html,body"),r=b("#img_mess"),t=b("#img_desc"),l=location.search;""!==l&&0===l.indexOf("?postto=")&&b("#img_type").val(l.slice(8));n.on("change","#img_choose",function(){k.prop("disabled",!0);b.each(this.files,function(a,f){if(/^image\/(jpeg|png|bmp|gif)$/.test(this.type)){var d=f.name;if(!b('img[data-name="'+d+'"]').length){var c=new FileReader,h=new Image;c.readAsDataURL(f);c.onload=function(a){h.src=a.target.result;var c=b("<img>",{src:a.target.result});c.watermark({path:" data:image/png;base64,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",done:function(a){var b=this.width,h=this.height;c.attr({src:a,"class":"watermark","data-width":b,"data-height":h,"data-name":d});e.append(c);c.wrap('<li class="ui-state-default"></li>');c.after('<div class="img_close">close</div><div class="img_details"><p><strong>Name</strong>: '+q(d)+"</p><p><strong>Size</strong>: ("+b+"x"+h+") "+p(f.size)+'</p></div><div class="img_progress_bar"><div class="img_progress"></div></div>')}})}}}});n.html('<input id="img_choose" type="file" multiple accept="image/*" /><span>Ch\u1ecdn \u1ea3nh</span>');e.sortable({placeholder:"ui-state-highlight",update:function(a,b){c()}}).disableSelection();k.prop("disabled",!1)});k.click(function(){e.find("li:not(.success)").each(function(a,e){var d=b(this),g=d.find("img").attr("src").replace(/data:image\/.+;base64\,/,"");d.removeClass("error").addClass("loading");b.ajax({url:"https://api.imgur.com/3/image",xhr:function(){var a=new window.XMLHttpRequest;a.upload.addEventListener("progress",function(a){a.lengthComputable&&d.find(".img_progress").css({width:a.loaded/a.total*100+"%"})},!1);return a},method:"POST",headers:{Authorization:"Client-ID bf5d07e8d4cc689"},data:{image:g,type:"base64"},success:function(a){var b=a.data.link;d.removeClass("loading").addClass("success");d.find(".img_details").html('<p><input class="img_bbcode" data-thumb="'+b.replace(/(.+)(\.)(png|jpg|gif|bmp)$/,"$1m.$3")+'" onclick="this.select();" type="text" value="[img]'+b+'[/img]" /></p><p><a href="'+b+'" target="_blank">Xem \u1ea3nh</a><a href="http://imgur.com/delete/'+a.data.deletehash+'" target="_blank">X\u00f3a \u1ea3nh</a></p>');c()},error:function(a){d.removeClass("loading").addClass("error");c();console.warn(a)}})})});m.click(function(){e.empty();g.slideUp()});e.on("click",".img_close",function(){b(this).parent().remove();c()})})(jQuery);
